#! /usr/bin/python
import fishmake
import pybase.config

def main():
	cli = pybase.config.CLIConfig()

	defaults = [
		("BUILD_DIR",      "build"),
		("SRC_DIR",        "src"),
		("INSTALL_PREFIX", "install"),
		("DOC_DIR",        "doc")
	]

	x = 1;
	extraToolChains = []
	while x in cli:
		extraToolChains.append(cli[x])
		x += 1

	fishmake.addToolChains(extraToolChains)

	fish = fishmake.FishMake(**{"defaults" : defaults})
	fish.configure()
	if   cli[0] == "clean":
		return fish.clean()
	elif cli[0] == "compile":
		return fish.compile()
	elif cli[0] == "install":
		return fish.install()
	elif cli[0] == "doc":
		return fish.doc()
	else:
		print "Usage: fishmake <clean|compile|install> [ToolChain[s]]"
		return 0

main()